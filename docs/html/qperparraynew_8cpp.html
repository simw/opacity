<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>opacity3: Gyulassy/opacity3/src/glv1/qperparraynew.cpp File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.3 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li><a href="annotated.html"><span>Classes</span></a></li>
    <li class="current"><a href="files.html"><span>Files</span></a></li>
  </ul>
</div>
<h1>Gyulassy/opacity3/src/glv1/qperparraynew.cpp File Reference</h1><code>#include &quot;<a class="el" href="qperparraynew_8h-source.html">qperparraynew.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="constants_8h-source.html">../constants.h</a>&quot;</code><br>

<p>
<a href="qperparraynew_8cpp-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qperparraynew_8cpp.html#2038a405262755765309ef166e170a95">_FillFirstRow</a> (unsigned long n, unsigned long z, std::vector&lt; bool &gt; zeroed, array2D &amp;qiqjs, array3D &amp;sumqiqjs)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qperparraynew_8cpp.html#fa7bacdc3db3da4a62517d2518826fbc">_FillNextRow</a> (unsigned long n, unsigned long i, unsigned long z, std::vector&lt; bool &gt; zeroed, array2D &amp;qiqjs, array3D &amp;sumqiqjs)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qperparraynew_8cpp.html#e6e4ce05ca5129920fbf7d9ef0a1e88f">_FillAllRows2DSymmetric</a> (unsigned long n, array2D &amp;qiqjs, array3D &amp;sumqiqjs, long z)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qperparraynew_8cpp.html#6e28f19c83c2c6e49a2672873048fd10">_FillAllRows1D</a> (unsigned long n, array1D &amp;khatqis, array2D &amp;sumkhatqis, long z)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qperparraynew_8cpp.html#d834a8fc7dd96237188220f0ed214a38">_Fill2DFrom1D</a> (unsigned long n, array2D &amp;sumkhatqi_iton, array3D &amp;sumkhatqikhatqj_itonjton, long z)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qperparraynew_8cpp.html#3b87a5052e73e5de13161681e25cf1fa">_DotProducts2D</a> (unsigned long n, MyArray &amp;mags, MyArray &amp;ths, array2D &amp;res)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qperparraynew_8cpp.html#aea824af3e9dc625dd755fe24f0492b2">_DotProducts1D</a> (unsigned long n, double mag1, double th1, MyArray &amp;mags, MyArray &amp;ths, array1D &amp;res)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qperparraynew_8cpp.html#7d756d821e729c3031739ae9168483e4">_OuterProduct1D1D</a> (unsigned long n, MyArray &amp;mags1, MyArray &amp;ths1, MyArray &amp;mags2, MyArray &amp;ths2, array2D &amp;res)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qperparraynew_8cpp.html#fc899dbd2fbe818860b4c384c52fb84f">_OuterProduct0D1D</a> (unsigned long n, double mag1, double th1, MyArray &amp;mags2, MyArray &amp;ths2, array1D &amp;res)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qperparraynew_8cpp.html#5e634626e89e347ac7105f3a34a7f065">_Iterate2DForZeroes</a> (unsigned long n, array2D &amp;qiqjs, array3D &amp;sumqiqjs)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qperparraynew_8cpp.html#9b9808a1bf16458a7ebdf81287337ec5">_Iterate1DForZeroes</a> (unsigned long n, array1D &amp;khatqis, array2D &amp;sumkhatqis)</td></tr>

</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="aea824af3e9dc625dd755fe24f0492b2"></a><!-- doxytag: member="qperparraynew.cpp::_DotProducts1D" ref="aea824af3e9dc625dd755fe24f0492b2" args="(unsigned long n, double mag1, double th1, MyArray &amp;mags, MyArray &amp;ths, array1D &amp;res)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void @8::_DotProducts1D           </td>
          <td>(</td>
          <td class="paramtype">unsigned long&nbsp;</td>
          <td class="paramname"> <em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>mag1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>th1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MyArray &amp;&nbsp;</td>
          <td class="paramname"> <em>mags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MyArray &amp;&nbsp;</td>
          <td class="paramname"> <em>ths</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">array1D &amp;&nbsp;</td>
          <td class="paramname"> <em>res</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="qperparraynew_8cpp-source.html#l00147">147</a> of file <a class="el" href="qperparraynew_8cpp-source.html">qperparraynew.cpp</a>.</p>

<p>Referenced by <a class="el" href="qperparraynew_8cpp-source.html#l00248">QperpCalculator::CalcQmatrices2()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00149"></a>00149 {
<a name="l00150"></a>00150   <span class="comment">// TODO: put in asserts to check that the dimensions of mags, ths and res are correct</span>
<a name="l00151"></a>00151 
<a name="l00152"></a>00152   <span class="comment">// No need to pre-calculate the cosine this time, we'll just jump in</span>
<a name="l00153"></a>00153   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i!=n; ++i)
<a name="l00154"></a>00154     res[i] = mag1 * mags[i] * cos( th1 - ths[i] );
<a name="l00155"></a>00155 
<a name="l00156"></a>00156   <span class="comment">// And we're done!</span>
<a name="l00157"></a>00157 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="3b87a5052e73e5de13161681e25cf1fa"></a><!-- doxytag: member="qperparraynew.cpp::_DotProducts2D" ref="3b87a5052e73e5de13161681e25cf1fa" args="(unsigned long n, MyArray &amp;mags, MyArray &amp;ths, array2D &amp;res)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void @8::_DotProducts2D           </td>
          <td>(</td>
          <td class="paramtype">unsigned long&nbsp;</td>
          <td class="paramname"> <em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MyArray &amp;&nbsp;</td>
          <td class="paramname"> <em>mags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MyArray &amp;&nbsp;</td>
          <td class="paramname"> <em>ths</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">array2D &amp;&nbsp;</td>
          <td class="paramname"> <em>res</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="qperparraynew_8cpp-source.html#l00111">111</a> of file <a class="el" href="qperparraynew_8cpp-source.html">qperparraynew.cpp</a>.</p>

<p>Referenced by <a class="el" href="qperparraynew_8cpp-source.html#l00248">QperpCalculator::CalcQmatrices2()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00112"></a>00112 {
<a name="l00113"></a>00113   <span class="comment">// TODO: put in asserts to check that the dimensions of mags, ths and res are correct</span>
<a name="l00114"></a>00114 
<a name="l00115"></a>00115   <span class="comment">// The operations sin and cos are numerically expensive</span>
<a name="l00116"></a>00116   <span class="comment">// For the dot products: will need cos( ths[i] - ths[j] )</span>
<a name="l00117"></a>00117   <span class="comment">// = cos(ths[i]) cos(ths[j]) + sin(ths[i]) sin(ths[j])</span>
<a name="l00118"></a>00118   <span class="comment">// Here: evaluate them 2n times, instead of possibly n^2 or 0.5*n(n+1)</span>
<a name="l00119"></a>00119   <a class="code" href="namespaceSwArrays.html#817a6066415ba9925ccc7d7574a4845b">MyArray</a> sines(n), cosines(n);
<a name="l00120"></a>00120   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i!=n; ++i)
<a name="l00121"></a>00121   {
<a name="l00122"></a>00122     sines[i] = sin( ths[i] );
<a name="l00123"></a>00123     cosines[i] = cos( ths[i] );
<a name="l00124"></a>00124   }
<a name="l00125"></a>00125 
<a name="l00126"></a>00126   <span class="comment">// Now, find the 2D matrix qi.qj</span>
<a name="l00127"></a>00127   <span class="comment">// We know that it is symmetric, so first we'll evaluate the off-diagonal on</span>
<a name="l00128"></a>00128   <span class="comment">// one side, then mirror it over to the other side</span>
<a name="l00129"></a>00129   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i!=n; ++i)
<a name="l00130"></a>00130     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> j=i+1; j!=n; ++j)
<a name="l00131"></a>00131     {
<a name="l00132"></a>00132       res[i][j] = mags[i] * mags[j] * ( cosines[i]*cosines[j] + sines[i]*sines[j] );
<a name="l00133"></a>00133       res[j][i] = res[i][j];
<a name="l00134"></a>00134     }
<a name="l00135"></a>00135 
<a name="l00136"></a>00136   <span class="comment">// Now all that's left is the diagonal</span>
<a name="l00137"></a>00137   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i!=n; ++i)
<a name="l00138"></a>00138     res[i][i] = mags[i] * mags[i];
<a name="l00139"></a>00139 
<a name="l00140"></a>00140   <span class="comment">// And we're done!</span>
<a name="l00141"></a>00141 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="d834a8fc7dd96237188220f0ed214a38"></a><!-- doxytag: member="qperparraynew.cpp::_Fill2DFrom1D" ref="d834a8fc7dd96237188220f0ed214a38" args="(unsigned long n, array2D &amp;sumkhatqi_iton, array3D &amp;sumkhatqikhatqj_itonjton, long z)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void @8::_Fill2DFrom1D           </td>
          <td>(</td>
          <td class="paramtype">unsigned long&nbsp;</td>
          <td class="paramname"> <em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">array2D &amp;&nbsp;</td>
          <td class="paramname"> <em>sumkhatqi_iton</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">array3D &amp;&nbsp;</td>
          <td class="paramname"> <em>sumkhatqikhatqj_itonjton</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&nbsp;</td>
          <td class="paramname"> <em>z</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="qperparraynew_8cpp-source.html#l00090">90</a> of file <a class="el" href="qperparraynew_8cpp-source.html">qperparraynew.cpp</a>.</p>

<p>Referenced by <a class="el" href="qperparraynew_8cpp-source.html#l00248">QperpCalculator::CalcQmatrices2()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00092"></a>00092 {
<a name="l00093"></a>00093   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i&lt;n; ++i)
<a name="l00094"></a>00094   {
<a name="l00095"></a>00095     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> j=0; j&lt;n; ++j)
<a name="l00096"></a>00096     {
<a name="l00097"></a>00097       sumkhatqikhatqj_itonjton[z][i][j] = sumkhatqi_iton[z][i] + sumkhatqi_iton[z][j];
<a name="l00098"></a>00098     }
<a name="l00099"></a>00099     sumkhatqikhatqj_itonjton[z][i][n] = sumkhatqi_iton[z][i];
<a name="l00100"></a>00100   }
<a name="l00101"></a>00101   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> j=0; j&lt;n; ++j)
<a name="l00102"></a>00102   {
<a name="l00103"></a>00103     sumkhatqikhatqj_itonjton[z][n][j] = sumkhatqi_iton[z][j];
<a name="l00104"></a>00104   }
<a name="l00105"></a>00105   sumkhatqikhatqj_itonjton[z][n][n] = 0.;
<a name="l00106"></a>00106 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="6e28f19c83c2c6e49a2672873048fd10"></a><!-- doxytag: member="qperparraynew.cpp::_FillAllRows1D" ref="6e28f19c83c2c6e49a2672873048fd10" args="(unsigned long n, array1D &amp;khatqis, array2D &amp;sumkhatqis, long z)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void @8::_FillAllRows1D           </td>
          <td>(</td>
          <td class="paramtype">unsigned long&nbsp;</td>
          <td class="paramname"> <em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">array1D &amp;&nbsp;</td>
          <td class="paramname"> <em>khatqis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">array2D &amp;&nbsp;</td>
          <td class="paramname"> <em>sumkhatqis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&nbsp;</td>
          <td class="paramname"> <em>z</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="qperparraynew_8cpp-source.html#l00075">75</a> of file <a class="el" href="qperparraynew_8cpp-source.html">qperparraynew.cpp</a>.</p>

<p>References <a class="el" href="constants_8h-source.html#l00043">SwUtils::_NumberToBoolArray()</a>.</p>

<p>Referenced by <a class="el" href="qperparraynew_8cpp-source.html#l00248">QperpCalculator::CalcQmatrices2()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00076"></a>00076 {
<a name="l00077"></a>00077   <span class="comment">// We will be stepping through setting each qi to zero</span>
<a name="l00078"></a>00078   <span class="comment">// Create a vector of bools to indicate which qi is zero for this iteration</span>
<a name="l00079"></a>00079   std::vector&lt;bool&gt; zeroed( n );
<a name="l00080"></a>00080 
<a name="l00081"></a>00081   <span class="comment">// Convert number z to an array of bools, the ith element saying whether qi should be zero</span>
<a name="l00082"></a>00082   <a class="code" href="namespaceSwUtils.html#1b9e53b0f01225242c82fe97e878bd6d">_NumberToBoolArray</a>( z, zeroed, n ); 
<a name="l00083"></a>00083   <span class="comment">// Starting point for the iteration: (n-1)th has just one element, khat.q_{n-1}</span>
<a name="l00084"></a>00084   sumkhatqis[z][n-1] = (!zeroed[n-1])*khatqis[n-1];
<a name="l00085"></a>00085   <span class="comment">// Now iterate over the rest, adding one khatqi at each step</span>
<a name="l00086"></a>00086   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=2; i&lt;(n+1); ++i)
<a name="l00087"></a>00087     sumkhatqis[z][n-i] = sumkhatqis[z][n-i+1] + (!zeroed[n-i])*khatqis[n-i];
<a name="l00088"></a>00088 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="e6e4ce05ca5129920fbf7d9ef0a1e88f"></a><!-- doxytag: member="qperparraynew.cpp::_FillAllRows2DSymmetric" ref="e6e4ce05ca5129920fbf7d9ef0a1e88f" args="(unsigned long n, array2D &amp;qiqjs, array3D &amp;sumqiqjs, long z)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void @8::_FillAllRows2DSymmetric           </td>
          <td>(</td>
          <td class="paramtype">unsigned long&nbsp;</td>
          <td class="paramname"> <em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">array2D &amp;&nbsp;</td>
          <td class="paramname"> <em>qiqjs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">array3D &amp;&nbsp;</td>
          <td class="paramname"> <em>sumqiqjs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&nbsp;</td>
          <td class="paramname"> <em>z</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="qperparraynew_8cpp-source.html#l00066">66</a> of file <a class="el" href="qperparraynew_8cpp-source.html">qperparraynew.cpp</a>.</p>

<p>References <a class="el" href="qperparraynew_8cpp-source.html#l00024">_FillFirstRow()</a>, <a class="el" href="qperparraynew_8cpp-source.html#l00051">_FillNextRow()</a>, and <a class="el" href="constants_8h-source.html#l00043">SwUtils::_NumberToBoolArray()</a>.</p>

<p>Referenced by <a class="el" href="qperparraynew_8cpp-source.html#l00248">QperpCalculator::CalcQmatrices2()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00067"></a>00067 {
<a name="l00068"></a>00068   std::vector&lt;bool&gt; zeroed( n );
<a name="l00069"></a>00069   <a class="code" href="namespaceSwUtils.html#1b9e53b0f01225242c82fe97e878bd6d">_NumberToBoolArray</a>( z, zeroed, n ); 
<a name="l00070"></a>00070   <a class="code" href="qperparraynew_8cpp.html#2038a405262755765309ef166e170a95">_FillFirstRow</a>( n, z, zeroed, qiqjs, sumqiqjs );
<a name="l00071"></a>00071   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=2; i&lt;(n+1); ++i)
<a name="l00072"></a>00072     <a class="code" href="qperparraynew_8cpp.html#fa7bacdc3db3da4a62517d2518826fbc">_FillNextRow</a>( n, n-i, z, zeroed, qiqjs, sumqiqjs );
<a name="l00073"></a>00073 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="2038a405262755765309ef166e170a95"></a><!-- doxytag: member="qperparraynew.cpp::_FillFirstRow" ref="2038a405262755765309ef166e170a95" args="(unsigned long n, unsigned long z, std::vector&lt; bool &gt; zeroed, array2D &amp;qiqjs, array3D &amp;sumqiqjs)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void @8::_FillFirstRow           </td>
          <td>(</td>
          <td class="paramtype">unsigned long&nbsp;</td>
          <td class="paramname"> <em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&nbsp;</td>
          <td class="paramname"> <em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; bool &gt;&nbsp;</td>
          <td class="paramname"> <em>zeroed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">array2D &amp;&nbsp;</td>
          <td class="paramname"> <em>qiqjs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">array3D &amp;&nbsp;</td>
          <td class="paramname"> <em>sumqiqjs</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="qperparraynew_8cpp-source.html#l00024">24</a> of file <a class="el" href="qperparraynew_8cpp-source.html">qperparraynew.cpp</a>.</p>

<p>Referenced by <a class="el" href="qperparraynew_8cpp-source.html#l00066">_FillAllRows2DSymmetric()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00026"></a>00026 {
<a name="l00027"></a>00027   <span class="comment">// If the (n-1)th row is zeroed, jump ahead to the answer</span>
<a name="l00028"></a>00028   <span class="keywordflow">if</span> (zeroed[n-1])
<a name="l00029"></a>00029   {
<a name="l00030"></a>00030     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i&lt;n; ++i)
<a name="l00031"></a>00031     {
<a name="l00032"></a>00032       sumqiqjs[z][n-1][i] = 0.; sumqiqjs[z][i][n-1] = 0.;
<a name="l00033"></a>00033     }
<a name="l00034"></a>00034   }
<a name="l00035"></a>00035   <span class="keywordflow">else</span>
<a name="l00036"></a>00036   {
<a name="l00037"></a>00037     <span class="comment">// The bottom right hand corner of the matrix has just one contribution</span>
<a name="l00038"></a>00038     sumqiqjs[z][n-1][n-1] = qiqjs[n-1][n-1];
<a name="l00039"></a>00039 
<a name="l00040"></a>00040     <span class="comment">// Now fill in the lower row and the right most column</span>
<a name="l00041"></a>00041     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=2; i&lt;(n+1); ++i)
<a name="l00042"></a>00042     {
<a name="l00043"></a>00043       sumqiqjs[z][n-1][n-i] = sumqiqjs[z][n-1][n-i+1] + (!zeroed[n-i])*qiqjs[n-1][n-i];
<a name="l00044"></a>00044       sumqiqjs[z][n-i][n-1] = sumqiqjs[z][n-1][n-i];
<a name="l00045"></a>00045     }
<a name="l00046"></a>00046   }
<a name="l00047"></a>00047 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="fa7bacdc3db3da4a62517d2518826fbc"></a><!-- doxytag: member="qperparraynew.cpp::_FillNextRow" ref="fa7bacdc3db3da4a62517d2518826fbc" args="(unsigned long n, unsigned long i, unsigned long z, std::vector&lt; bool &gt; zeroed, array2D &amp;qiqjs, array3D &amp;sumqiqjs)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void @8::_FillNextRow           </td>
          <td>(</td>
          <td class="paramtype">unsigned long&nbsp;</td>
          <td class="paramname"> <em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&nbsp;</td>
          <td class="paramname"> <em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&nbsp;</td>
          <td class="paramname"> <em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; bool &gt;&nbsp;</td>
          <td class="paramname"> <em>zeroed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">array2D &amp;&nbsp;</td>
          <td class="paramname"> <em>qiqjs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">array3D &amp;&nbsp;</td>
          <td class="paramname"> <em>sumqiqjs</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="qperparraynew_8cpp-source.html#l00051">51</a> of file <a class="el" href="qperparraynew_8cpp-source.html">qperparraynew.cpp</a>.</p>

<p>Referenced by <a class="el" href="qperparraynew_8cpp-source.html#l00066">_FillAllRows2DSymmetric()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00053"></a>00053 {
<a name="l00054"></a>00054   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> j=0; j&lt;(i+1); ++j)
<a name="l00055"></a>00055     sumqiqjs[z][i][i-j] = sumqiqjs[z][i+1][i-j] 
<a name="l00056"></a>00056         + sumqiqjs[z][i][i-j+1] - sumqiqjs[z][i+1][i-j+1] 
<a name="l00057"></a>00057         + (!zeroed[i])*(!zeroed[i-j])*qiqjs[i][i-j];
<a name="l00058"></a>00058 
<a name="l00059"></a>00059   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> j=1; j&lt;(i+1); ++j)
<a name="l00060"></a>00060     sumqiqjs[z][i-j][i] = sumqiqjs[z][i][i-j];
<a name="l00061"></a>00061 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="9b9808a1bf16458a7ebdf81287337ec5"></a><!-- doxytag: member="qperparraynew.cpp::_Iterate1DForZeroes" ref="9b9808a1bf16458a7ebdf81287337ec5" args="(unsigned long n, array1D &amp;khatqis, array2D &amp;sumkhatqis)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void @8::_Iterate1DForZeroes           </td>
          <td>(</td>
          <td class="paramtype">unsigned long&nbsp;</td>
          <td class="paramname"> <em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">array1D &amp;&nbsp;</td>
          <td class="paramname"> <em>khatqis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">array2D &amp;&nbsp;</td>
          <td class="paramname"> <em>sumkhatqis</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="qperparraynew_8cpp-source.html#l00331">331</a> of file <a class="el" href="qperparraynew_8cpp-source.html">qperparraynew.cpp</a>.</p>

<p>References <a class="el" href="constants_8h-source.html#l00043">SwUtils::_NumberToBoolArray()</a>.</p>

<p>Referenced by <a class="el" href="qperparraynew_8cpp-source.html#l00358">QperpCalculator::CalcQmatrices()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00332"></a>00332 {
<a name="l00333"></a>00333   std::vector&lt;bool&gt; zeroed(n);
<a name="l00334"></a>00334   <span class="keywordtype">double</span> tmp;
<a name="l00335"></a>00335   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> z=1; z&lt;pow(2,n); ++z)
<a name="l00336"></a>00336   {
<a name="l00337"></a>00337     <span class="comment">// First, calculate the array of zeroed bools</span>
<a name="l00338"></a>00338     <a class="code" href="namespaceSwUtils.html#1b9e53b0f01225242c82fe97e878bd6d">_NumberToBoolArray</a>( z, zeroed, n );
<a name="l00339"></a>00339     <span class="comment">// Now, iterated over all the elements</span>
<a name="l00340"></a>00340     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i&lt;n; ++i) 
<a name="l00341"></a>00341     { 
<a name="l00342"></a>00342       <span class="comment">// Now deal with k part</span>
<a name="l00343"></a>00343       tmp = sumkhatqis[0][i];
<a name="l00344"></a>00344       <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> ii=i; ii&lt;n; ++ii)
<a name="l00345"></a>00345       {
<a name="l00346"></a>00346         <span class="keywordflow">if</span> ( zeroed[ii] )
<a name="l00347"></a>00347         {
<a name="l00348"></a>00348           tmp -= khatqis[ii];
<a name="l00349"></a>00349         }
<a name="l00350"></a>00350       }
<a name="l00351"></a>00351       sumkhatqis[z][i] = tmp;
<a name="l00352"></a>00352     }
<a name="l00353"></a>00353   }
<a name="l00354"></a>00354 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="5e634626e89e347ac7105f3a34a7f065"></a><!-- doxytag: member="qperparraynew.cpp::_Iterate2DForZeroes" ref="5e634626e89e347ac7105f3a34a7f065" args="(unsigned long n, array2D &amp;qiqjs, array3D &amp;sumqiqjs)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void @8::_Iterate2DForZeroes           </td>
          <td>(</td>
          <td class="paramtype">unsigned long&nbsp;</td>
          <td class="paramname"> <em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">array2D &amp;&nbsp;</td>
          <td class="paramname"> <em>qiqjs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">array3D &amp;&nbsp;</td>
          <td class="paramname"> <em>sumqiqjs</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="qperparraynew_8cpp-source.html#l00301">301</a> of file <a class="el" href="qperparraynew_8cpp-source.html">qperparraynew.cpp</a>.</p>

<p>References <a class="el" href="constants_8h-source.html#l00043">SwUtils::_NumberToBoolArray()</a>.</p>

<p>Referenced by <a class="el" href="qperparraynew_8cpp-source.html#l00358">QperpCalculator::CalcQmatrices()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00302"></a>00302 {
<a name="l00303"></a>00303   <span class="comment">// Now we go through all the possible combinations of zeroed columns and rows</span>
<a name="l00304"></a>00304   std::vector&lt;bool&gt; zeroed( n );
<a name="l00305"></a>00305   <span class="keywordtype">double</span> tmp;
<a name="l00306"></a>00306   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> z=1; z&lt;pow(2,n); ++z)
<a name="l00307"></a>00307   {
<a name="l00308"></a>00308     <span class="comment">// First, calculate the array of zeroed bools</span>
<a name="l00309"></a>00309     <a class="code" href="namespaceSwUtils.html#1b9e53b0f01225242c82fe97e878bd6d">_NumberToBoolArray</a>( z, zeroed, n );
<a name="l00310"></a>00310     <span class="comment">// Now, iterated over all the elements</span>
<a name="l00311"></a>00311     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i&lt;n; ++i) 
<a name="l00312"></a>00312     { 
<a name="l00313"></a>00313       <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> j=0; j&lt;n; ++j) 
<a name="l00314"></a>00314       {
<a name="l00315"></a>00315         <span class="comment">// If either the row or column has been zeroed, subtract off from answer</span>
<a name="l00316"></a>00316         tmp = sumqiqjs[0][i][j];
<a name="l00317"></a>00317         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> ii=i; ii&lt;n; ii++)
<a name="l00318"></a>00318         {
<a name="l00319"></a>00319           <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> jj=j; jj&lt;n; jj++)
<a name="l00320"></a>00320           {
<a name="l00321"></a>00321             <span class="keywordflow">if</span> ( zeroed[ii] || zeroed[jj] )
<a name="l00322"></a>00322               tmp -= qiqjs[ii][jj];
<a name="l00323"></a>00323           }
<a name="l00324"></a>00324         }
<a name="l00325"></a>00325         sumqiqjs[z][i][j] = tmp;
<a name="l00326"></a>00326       }
<a name="l00327"></a>00327     }
<a name="l00328"></a>00328   }
<a name="l00329"></a>00329 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="fc899dbd2fbe818860b4c384c52fb84f"></a><!-- doxytag: member="qperparraynew.cpp::_OuterProduct0D1D" ref="fc899dbd2fbe818860b4c384c52fb84f" args="(unsigned long n, double mag1, double th1, MyArray &amp;mags2, MyArray &amp;ths2, array1D &amp;res)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void @8::_OuterProduct0D1D           </td>
          <td>(</td>
          <td class="paramtype">unsigned long&nbsp;</td>
          <td class="paramname"> <em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>mag1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>th1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MyArray &amp;&nbsp;</td>
          <td class="paramname"> <em>mags2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MyArray &amp;&nbsp;</td>
          <td class="paramname"> <em>ths2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">array1D &amp;&nbsp;</td>
          <td class="paramname"> <em>res</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="qperparraynew_8cpp-source.html#l00293">293</a> of file <a class="el" href="qperparraynew_8cpp-source.html">qperparraynew.cpp</a>.</p>

<p>Referenced by <a class="el" href="qperparraynew_8cpp-source.html#l00358">QperpCalculator::CalcQmatrices()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00294"></a>00294 {
<a name="l00295"></a>00295   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i!=n; ++i)
<a name="l00296"></a>00296     res[i] = mag1 * mags2[i] * cos( th1 - ths2[i] );
<a name="l00297"></a>00297 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="7d756d821e729c3031739ae9168483e4"></a><!-- doxytag: member="qperparraynew.cpp::_OuterProduct1D1D" ref="7d756d821e729c3031739ae9168483e4" args="(unsigned long n, MyArray &amp;mags1, MyArray &amp;ths1, MyArray &amp;mags2, MyArray &amp;ths2, array2D &amp;res)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void @8::_OuterProduct1D1D           </td>
          <td>(</td>
          <td class="paramtype">unsigned long&nbsp;</td>
          <td class="paramname"> <em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MyArray &amp;&nbsp;</td>
          <td class="paramname"> <em>mags1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MyArray &amp;&nbsp;</td>
          <td class="paramname"> <em>ths1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MyArray &amp;&nbsp;</td>
          <td class="paramname"> <em>mags2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MyArray &amp;&nbsp;</td>
          <td class="paramname"> <em>ths2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">array2D &amp;&nbsp;</td>
          <td class="paramname"> <em>res</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="qperparraynew_8cpp-source.html#l00280">280</a> of file <a class="el" href="qperparraynew_8cpp-source.html">qperparraynew.cpp</a>.</p>

<p>Referenced by <a class="el" href="qperparraynew_8cpp-source.html#l00358">QperpCalculator::CalcQmatrices()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00281"></a>00281 {
<a name="l00282"></a>00282   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i!=n; ++i)
<a name="l00283"></a>00283     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> j=i+1; j!=n; ++j)
<a name="l00284"></a>00284     {
<a name="l00285"></a>00285       res[i][j] = mags1[i] * mags2[j] * cos( ths1[i] - ths2[j] );
<a name="l00286"></a>00286       res[j][i] = res[i][j];
<a name="l00287"></a>00287     }
<a name="l00288"></a>00288   
<a name="l00289"></a>00289   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i!=n; ++i)
<a name="l00290"></a>00290     res[i][i] = mags1[i] * mags2[i];
<a name="l00291"></a>00291 }
</pre></div>
<p>

</div>
</div><p>
<hr size="1"><address style="text-align: right;"><small>Generated on Sat Nov 1 18:28:55 2008 for opacity3 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.3 </small></address>
</body>
</html>
